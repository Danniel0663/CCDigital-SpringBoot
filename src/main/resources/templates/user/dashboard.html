<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dashboard Usuario · CCDigital</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" th:href="@{/css/ccdigital.css}">
</head>

<body class="bg-body-tertiary">
<nav class="navbar cc-navbar">
  <div class="container d-flex justify-content-between align-items-center">
    <a class="navbar-brand fw-semibold text-decoration-none cc-brand" th:href="@{/user/dashboard}">
      <i class="bi bi-person-badge me-2"></i>CCDigital · Usuario
    </a>

    <form th:action="@{/user/logout}" method="post" style="margin:0;">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
      <button class="btn btn-outline-dark btn-sm" type="submit">
        Cerrar sesión
      </button>
    </form>
  </div>
</nav>

<main class="container py-4">

  <!-- Perfil -->
  <div class="cc-card p-4 mb-3">
    <div class="d-flex flex-wrap justify-content-between align-items-start gap-3">
      <div>
        <h1 class="h4 mb-1" th:text="${displayName}">Usuario</h1>

        <div class="d-flex flex-wrap gap-2">
          <span class="badge text-bg-secondary" th:text="${idType}">CC</span>
          <span class="badge text-bg-light border" th:text="${idNumber}">000</span>
          <span class="badge text-bg-light border" th:text="${email}">email</span>
        </div>

        <p class="text-muted small mt-3 mb-0">
          Datos del Usuario.
        </p>
      </div>

      <div class="text-end">
        <span class="badge text-bg-primary">
          <i class="bi bi-shield-check me-1"></i>Sesión activa
        </span>
      </div>
    </div>
  </div>

  <!-- Documentos -->
  <div class="cc-card p-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h2 class="h6 text-uppercase text-muted mb-0">Documentos en Fabric</h2>
      <span class="badge text-bg-light border" th:text="${#lists.size(docs)} + ' registros'">0 registros</span>
    </div>

    <div th:if="${#lists.isEmpty(docs)}" class="text-center text-muted py-4">
      No hay documentos registrados.
    </div>

    <div class="table-responsive" th:if="${!#lists.isEmpty(docs)}">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>Título</th>
            <th>Entidad</th>
            <th>Estado</th>
            <th>Creado</th>
            <th class="text-end">Acción</th>
          </tr>
        </thead>

        <tbody>
          <tr th:each="d : ${docs}">
            <td>
              <div class="fw-semibold" th:text="${d.title()}">Título</div>
              <div class="text-muted small" th:text="${d.sizeHuman()}">Tamaño</div>
            </td>

            <td class="text-muted" th:text="${d.issuingEntity()}">Fabric</td>

            <td>
              <span class="badge text-bg-secondary" th:text="${d.status()}">Registrado</span>
            </td>

            <td class="text-muted" th:text="${d.createdAtHuman()}">Fecha</td>

            <td class="text-end">
              <a class="btn btn-sm btn-outline-primary"
                 th:href="@{/user/docs/view/{docId}(docId=${d.docId()})}"
                 target="_blank"
                 rel="noopener">
                <i class="bi bi-eye me-1"></i>Ver
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
